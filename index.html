<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Private Cloud Memo</title>
<style>
  body {
    font-family: sans-serif;
    padding: 20px;
    max-width: 600px;
    margin: auto;
  }
  textarea {
    width: 100%;
    height: 300px;
    padding: 12px;
    font-size: 16px;
  }
  #status {
    margin-top: 10px;
    color: #333;
    font-size: 14px;
  }
</style>
</head>
<body>
<h2>개인 메모</h2>
<p>아무 PC에서나 텍스트 쓰면 Supabase로 자동 저장됩니다.</p>

<textarea id="memo" placeholder="여기에 메모를 입력하세요..."></textarea>
<div id="status">대기 중…</div>

<script type="module">
  import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

  // ★ 여기에 너의 Supabase URL / anon key 넣으면 바로 작동 ★
  const SUPABASE_URL = "https://wwxufqjcobsqipobutjt.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind3eHVmcWpjb2JzcWlwb2J1dGp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0Mzg5NDksImV4cCI6MjA4MDAxNDk0OX0.t0eWuxiOdbmngo8IEYTg_XYyaC1HKhp29aKaUmSg0_4";

  const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

  const textarea = document.getElementById("memo");
  const status = document.getElementById("status");

  let timer = null;

  textarea.addEventListener("input", () => {
    status.textContent = "저장 중...";
    if (timer) clearTimeout(timer);

    // 입력 멈추고 1초 뒤 저장
    timer = setTimeout(async () => {
      const content = textarea.value.trim();
      if (!content) {
        status.textContent = "내용 없음";
        return;
      }

      const { error } = await supabase.from("notes").insert({ content });

      if (error) {
        status.textContent = "저장 실패: " + error.message;
      } else {
        status.textContent = "저장됨 (" + new Date().toLocaleTimeString() + ")";
      }
    }, 1000);
  });
</script>

</body>
</html>
